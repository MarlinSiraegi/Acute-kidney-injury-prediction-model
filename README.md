# Acute-kidney-injury-prediction-model
분당서울대학교병원 급성신손상 환자 데이터톤  
  
  
## 데이터 전처리 및 통합  
일단, MIMIC-4 데이터셋에 있는 피처중에 급성신손상(AKI)과 관련있을만한 것들을 모두 선정해보았습니다.  
  
환자들의 ID를 기준으로시간 순서대로 나열되어있는 데이터들을 각 피처를 기준으로 전부 합쳐서 평균 및 표준편차를 내고, 그것들에 대해서 피처 중요도 검사(shap)를 실시해보았습니다.  
  
![image](https://github.com/user-attachments/assets/e13c4fd8-4367-4fcf-a26a-12a4215a35b7)  
  
그 결과, 혈청 크레아티닌, 염소, 나트륨, 중탄산염, 마그네슘, 헤모글로빈 등이 중요도 순위에서 상위로 나타났습니다.  
  
특이한 점은 대부분의 경우 평균값만 상위로 나타난 반면, 혈청 크레아티닌 값만 표준편차가 중요도에서 상위로 나타났습니다.  
  
일반적으로 평균값이 중요한 경향이 있지만, 표준편차값이 이 정도로 상위로 나온다면 예측에 의미가 있을 수 있으므로 학습에 포함시키는 것을 고려해야 한다는 것으로 받아들여졌습니다.  
  
  
  
## 모델링  
  
### 학습 설정  
  
#### 모델 : FT-Transformer  
FT-Transformer 모델은 특히 테이블 형식의 데이터에 적합한 딥러닝 모델입니다.  
이 모델은 입력 데이터를 임베딩하여 Transformer 구조에서 사용하는 어텐션(Attention) 매커니즘을 적용합니다.  
이를 통해 각 피처간 상호작용을 학습하며, 다양한 테이블 형식의 데이터에서 높은 예측 성능을 발휘합니다.  
  
#### 옵티마이저 : AdamW  
AdamW 옵티마이저는 가중치 감쇠(weight decay)를 적용하여 과적합을 방지하고, 효율적인 학습을 돕는 최적화 알고리즘입니다.  
  
#### 손실 함수 : CrossEntropyLoss  
이진 분류 문제에서 CrossEntropyLoss는 예측 확률과 실제 라벨 간의 차이를 최소화하는 데 사용됩니다. 급성 신손상(AKI)의 발생 여부를 예측하는 이진 분류 문제에서, CrossEntropyLoss는 모델이 정답 클래스에 가까운 확률을 출력하도록 학습을 유도합니다. 이를 통해 모델이 정확하게 AKI 발생 여부를 구분할 수 있도록 도와줍니다.  
  
#### 스케쥴러 : ReduceLROnPlateau  
ReduceLROnPlateau는 성능 개선이 정체될 때 학습률을 줄여 더 나은 최적화를 도모하는 스케줄러입니다. 이를 통해 모델이 학습률을 자동으로 조정하며, 최적의 성능을 발휘할 수 있도록 도와줍니다.  
평가지표 : Accuracy, F1-Score, ROC-AUC(auroc)  

